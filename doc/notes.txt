Заметки на полях.

1. разпараллелить работу невозможно (точно ?). работа идет последовательно, нам всегда важен результат обработки предыдущих строк.
2. Строки - узкое место. вся работа с строками идет через обращения []. А они работают через кучу проверок и преобразований типов от базового к наследникам.
Требуется привести работу к
 - String базовый класс. Но используется только тогда, когда допустимо передавать разные типы наследники. В "ядре" использование должно быть минимальным.
    делается полностью абстрактным - нет обращений к наследникам, как сейчас.
 - оригинальный DString переименовывается в CString (convert string). используется только для обработки входных строк неизвестной нам кодировки, формата.
 - SString основной класс строк. строка хранится в внутреннем формате (wchar/char16_t). Из других типов преобразовывается через CString. используем его максмально возможно.
 - DString динамическая строка. наследуется от SString. Используется в случаях доступа к подстроке из SString. не изменяем.

 В SString обращение [] должно идти без проверок диапазона. если вышли - падаем.
3. после реализации пункта 2, требуется переход на pcre в части регулярных выражений. путем реализации фишек colorer через "дополнение" регулярного выражения.
4. Exception должен быть наследником от std::exception. Хранит строку в SString.